<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced Reorderable Demos with moveBefore</title>
    <style>
      body {
        max-width: 700px;
        margin: 0 auto;
        padding: 40px;
        font-family: Georgia, serif;
        background: #f8f8f8;
        line-height: 1.6;
      }

      h1 {
        margin: 0 0 24px 0;
        font-size: 32px;
        font-weight: normal;
        color: #222;
      }

      p {
        margin: 0 0 32px 0;
        color: #444;
        max-width: 600px;
      }

      ul,
      ol {
        padding: 0;
        margin: 32px 0;
        max-width: 500px;
      }

      ul {
        list-style: none;
      }

      /* 
        CSS counters workaround for moveBefore API bug:
        Native list-style: decimal doesn't update correctly with moveBefore().
        This should be temporary until the browser bug is fixed.
      */
      ol {
        list-style: none;
        counter-reset: ordered-counter;
      }

      ol li {
        counter-increment: ordered-counter;
      }

      ol li::before {
        content: counter(ordered-counter) '. ';
        font-weight: bold;
        margin-right: 8px;
      }

      [folk-reorderable] {
        background: white;
        border: 1px solid #ddd;
        padding: 12px 16px;
        margin: 8px 0;
        cursor: grab;
        transition: transform 0.2s ease;
        border-radius: 4px;
      }

      [folk-reorderable]:hover {
        transform: translate(var(--drag-x, 0px), var(--drag-y, 0px)) translateY(-1px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border-color: #999;
      }

      [folk-reorderable][aria-grabbed='true'] {
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        transform: translate(var(--drag-x, 0px), var(--drag-y, 0px)) rotate(1deg);
        cursor: grabbing;
        transition: none;
        border-color: #666;
        background: #fafafa;
      }

      ol [folk-reorderable] {
        background: #f5f5f5;
      }

      ol [folk-reorderable][aria-grabbed='true'] {
        background: #eee;
      }

      /* Horizontal layouts */
      .horizontal-list {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
        margin: 32px 0;
        padding: 16px;
        background: white;
        border-radius: 8px;
        border: 1px solid #ddd;
      }

      .horizontal-list [folk-reorderable] {
        margin: 0;
        flex-shrink: 0;
      }

      .tag {
        padding: 6px 12px;
        background: #e1f5fe;
        border: 1px solid #81d4fa;
        border-radius: 16px;
        font-size: 14px;
        white-space: nowrap;
      }

      .tag[aria-grabbed='true'] {
        background: #b3e5fc;
        border-color: #4fc3f7;
      }

      .card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 16px;
        width: 200px;
        text-align: center;
      }

      .card img {
        max-width: 100%;
        height: 120px;
        object-fit: cover;
        border-radius: 4px;
      }

      /* Complex nested layout */
      .nested-demo {
        background: #f0f0f0;
        padding: 20px;
        border-radius: 8px;
        margin: 32px 0;
      }

      .nested-demo > [folk-reorderable] {
        background: #ffffff;
        margin: 12px 0;
        padding: 16px;
        border: 2px solid #ddd;
        border-radius: 6px;
      }

      .nested-demo .inner-list {
        margin: 12px 0 0 0;
        padding: 0;
        list-style: none;
      }

      .nested-demo .inner-list [folk-reorderable] {
        background: #f8f8f8;
        margin: 6px 0;
        padding: 8px 12px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
      }

      /* Form demo */
      .form-demo {
        background: white;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #ddd;
        margin: 32px 0;
      }

      .form-demo [folk-reorderable] {
        background: #fafafa;
        border: 1px solid #e0e0e0;
        margin: 12px 0;
        padding: 16px;
        border-radius: 4px;
      }

      .form-demo input,
      .form-demo textarea,
      .form-demo select {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-top: 4px;
      }

      .form-demo label {
        font-weight: bold;
        font-size: 14px;
      }

      /* Size variety demo */
      .size-variety {
        display: flex;
        gap: 12px;
        align-items: flex-start;
        flex-wrap: wrap;
        margin: 32px 0;
        padding: 16px;
        background: white;
        border-radius: 8px;
        border: 1px solid #ddd;
      }

      .size-variety [folk-reorderable] {
        margin: 0;
        background: #f5f5f5;
        border: 1px solid #ddd;
        border-radius: 6px;
        padding: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-size: 12px;
      }

      .tiny {
        width: 60px;
        height: 60px;
      }
      .small {
        width: 100px;
        height: 80px;
      }
      .medium {
        width: 150px;
        height: 100px;
      }
      .large {
        width: 200px;
        height: 120px;
      }
      .tall {
        width: 80px;
        height: 160px;
      }
      .wide {
        width: 250px;
        height: 60px;
      }

      /* Canvas demo */
      .canvas-container [folk-reorderable] {
        margin: 8px;
        background: white;
        border: 2px solid #ddd;
        border-radius: 8px;
        padding: 8px;
        display: inline-block;
      }

      .canvas-container canvas {
        border: 1px solid #ccc;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <h1>Advanced Reorderable Demos with moveBefore</h1>

    <p>
      Drag items to reorder them using the new
      <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/moveBefore">moveBefore</a> API. This lets us
      move elements around the DOM without losing state, opening up a ton if interesting possibilities we hope to
      explore.
    </p>

    <h3>Research outline:</h3>
    <ul>
      <li folk-reorderable>Abstract and introduction to chromatic pachyderms</li>
      <li folk-reorderable>Literature review of purple mammals in academic discourse</li>
      <li folk-reorderable>Methodology for observing fictional elephant populations</li>
      <li folk-reorderable>Statistical analysis of imaginary color variations</li>
      <li folk-reorderable>Discussion of implications for theoretical zoology</li>
      <li folk-reorderable>Conclusion and future research directions</li>
    </ul>

    <h3>Writing process:</h3>
    <ol>
      <li folk-reorderable>Draft the theoretical framework for purple elephant studies</li>
      <li folk-reorderable>Compile references from speculative biology journals</li>
      <li folk-reorderable>Write methodology section using hypothetical field observations</li>
      <li folk-reorderable>Create data visualizations of imaginary measurements</li>
      <li folk-reorderable>Develop arguments for the evolutionary advantages of purple coloration</li>
      <li folk-reorderable>Peer review with colleagues in fictional animal studies</li>
      <li folk-reorderable style="display: flex; align-items: flex-start; gap: 0.5rem"
        ><video src="/dancing-flower.webm" autoplay controls loop style="max-width: 10rem; flex-shrink: 0"></video
        ><span>Notice that the video state persists as it moves around the DOM</span></li
      >
      <li>(this list element does not have the folk-reorderable attribute)</li>
    </ol>

    <h3>Horizontal tags (try reordering these):</h3>
    <div class="horizontal-list">
      <div folk-reorderable class="tag">JavaScript</div>
      <div folk-reorderable class="tag">TypeScript</div>
      <div folk-reorderable class="tag">Web Components</div>
      <div folk-reorderable class="tag">CSS Grid</div>
      <div folk-reorderable class="tag">DOM API</div>
      <div folk-reorderable class="tag">Accessibility</div>
      <div folk-reorderable class="tag">Performance</div>
    </div>

    <h3>Image gallery cards:</h3>
    <div class="horizontal-list">
      <div folk-reorderable class="card">
        <img src="/dancing-flower.webm" alt="Dancing flower" />
        <h4>Dancing Flower</h4>
        <p>Animated nature</p>
      </div>
      <div folk-reorderable class="card">
        <div
          style="
            width: 100%;
            height: 120px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
          "
        >
          Gradient
        </div>
        <h4>Abstract Art</h4>
        <p>Color study</p>
      </div>
      <div folk-reorderable class="card">
        <div
          style="width: 100%; height: 120px; background: #333; border-radius: 4px; position: relative; overflow: hidden"
        >
          <div
            style="
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              color: white;
              font-size: 24px;
            "
            >📊</div
          >
        </div>
        <h4>Data Viz</h4>
        <p>Charts & graphs</p>
      </div>
    </div>

    <h3>Form inputs that preserve state (type in them, then reorder!):</h3>
    <div class="form-demo">
      <div folk-reorderable>
        <label>Your name:</label>
        <input type="text" placeholder="Enter your full name..." value="" />
      </div>
      <div folk-reorderable>
        <label>Email address:</label>
        <input type="email" placeholder="your.email@example.com" value="" />
      </div>
      <div folk-reorderable>
        <label>Favorite color:</label>
        <select>
          <option value="">Choose a color...</option>
          <option value="red">Red</option>
          <option value="blue">Blue</option>
          <option value="green">Green</option>
          <option value="purple">Purple (like elephants)</option>
        </select>
      </div>
      <div folk-reorderable>
        <label>Additional comments:</label>
        <textarea rows="3" placeholder="Share your thoughts..."></textarea>
      </div>
      <div folk-reorderable style="display: flex; align-items: center; gap: 8px">
        <input type="checkbox" id="newsletter" />
        <label for="newsletter">Subscribe to our elephant newsletter</label>
      </div>
    </div>

    <h3>Mixed sizes that would confuse other libraries:</h3>
    <div class="size-variety">
      <div folk-reorderable class="tiny">Tiny<br />60×60</div>
      <div folk-reorderable class="large">Large box<br />200×120</div>
      <div folk-reorderable class="small">Small<br />100×80</div>
      <div folk-reorderable class="tall">Tall<br />narrow<br />80×160</div>
      <div folk-reorderable class="medium">Medium<br />150×100</div>
      <div folk-reorderable class="wide">Wide and shallow 250×60</div>
    </div>

    <h3>Nested reorderable lists (both levels are independently reorderable!):</h3>
    <div class="nested-demo">
      <div folk-reorderable>
        <strong>🏠 Home Renovation</strong>
        <ul class="inner-list">
          <li folk-reorderable>Paint living room walls</li>
          <li folk-reorderable>Install new light fixtures</li>
          <li folk-reorderable>Replace kitchen cabinets</li>
        </ul>
      </div>
      <div folk-reorderable>
        <strong>🌱 Garden Planning</strong>
        <ul class="inner-list">
          <li folk-reorderable>Plant spring flowers</li>
          <li folk-reorderable>Build raised vegetable beds</li>
          <li folk-reorderable>Install irrigation system</li>
        </ul>
      </div>
      <div folk-reorderable>
        <strong>💼 Work Projects</strong>
        <ul class="inner-list">
          <li folk-reorderable>Update portfolio website</li>
          <li folk-reorderable>Prepare quarterly presentation</li>
          <li folk-reorderable>Review team performance metrics</li>
        </ul>
      </div>
    </div>

    <h3>Canvas elements with drawings (state persists!):</h3>
    <div class="canvas-container">
      <div folk-reorderable>
        <canvas width="150" height="100" style="background: #ffe0e0" id="canvas1"></canvas>
        <div style="text-align: center; margin-top: 8px; font-size: 12px">Red canvas</div>
      </div>
      <div folk-reorderable>
        <canvas width="150" height="100" style="background: #e0ffe0" id="canvas2"></canvas>
        <div style="text-align: center; margin-top: 8px; font-size: 12px">Green canvas</div>
      </div>
      <div folk-reorderable>
        <canvas width="150" height="100" style="background: #e0e0ff" id="canvas3"></canvas>
        <div style="text-align: center; margin-top: 8px; font-size: 12px">Blue canvas</div>
      </div>
    </div>

    <h3>CSS animations that continue running:</h3>
    <div class="horizontal-list">
      <div
        folk-reorderable
        style="
          width: 100px;
          height: 100px;
          background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
          animation: rotate 3s linear infinite;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: bold;
        "
      >
        Spin
      </div>
      <div
        folk-reorderable
        style="
          width: 100px;
          height: 100px;
          background: linear-gradient(90deg, #a8e6cf, #88d8c0);
          animation: pulse 2s ease-in-out infinite;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: bold;
        "
      >
        Pulse
      </div>
      <div
        folk-reorderable
        style="
          width: 100px;
          height: 100px;
          background: linear-gradient(135deg, #ffd93d, #ff9f43);
          animation: bounce 1.5s ease infinite;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: bold;
        "
      >
        Bounce
      </div>
    </div>

    <style>
      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
    </style>

    <p style="margin-top: 40px; padding: 20px; background: #f0f8ff; border-radius: 8px; border-left: 4px solid #4a90e2">
      <strong>Why this works:</strong> Unlike traditional drag-and-drop libraries that clone elements or manipulate
      their innerHTML, this uses the native <code>moveBefore()</code> API to physically relocate DOM nodes. This
      preserves all element state: form values, video playback position, canvas drawings, running animations, event
      listeners, and even complex nested structures. It's a web-native approach that leverages the platform rather than
      fighting against it.
    </p>

    <script type="module">
      import '@folkjs/labs/standalone/folk-reorderable';

      // Draw some initial content on the canvases
      function drawOnCanvas(canvasId, color) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');

        // Draw a simple pattern
        ctx.fillStyle = color;
        ctx.fillRect(20, 20, 50, 30);
        ctx.fillStyle = 'white';
        ctx.font = '12px Arial';
        ctx.fillText('Drag me!', 25, 40);

        // Add click handler to draw circles
        canvas.addEventListener('click', (e) => {
          const rect = canvas.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          ctx.fillStyle = color;
          ctx.beginPath();
          ctx.arc(x, y, 5, 0, 2 * Math.PI);
          ctx.fill();
        });
      }

      drawOnCanvas('canvas1', '#ff6b6b');
      drawOnCanvas('canvas2', '#4ecdc4');
      drawOnCanvas('canvas3', '#6c5ce7');
    </script>
  </body>
</html>
